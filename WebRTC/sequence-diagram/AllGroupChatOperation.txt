@startuml
title Group chat operations Operations
hide footbox
participant "Endpoint A" as EPA
participant "AT&T API Gateway" as Gateway
participant "Endpoint B" as EPB
participant "Endpoint C" as EPC

note over EPA, EPC
1. Endpoints have valid session established with gateway.
2. Endpoints have established event channel to get notification of network events. 
end note


note over EPA, Gateway
1 Endpoint A create chat group. with member as B
end note
EPA -> Gateway:POST /sessions/{sessionId}/groups(group)
Gateway-->EPA: 202 Accepted (location)


note over Gateway, EPB
2. Endpoint B receives group invitation event on event  channel with following details.
   event(type=groups, subType=invitation)
end note
note over Gateway, EPB
3. Endpoint B respond by accepting / rejecting the invitation
end note
EPB -> Gateway:PUT /sessions/{sessionId}/groups/{groupId}(x-inviation=accept|decline)
Gateway-->EPB: 200 OK 


note over EPA, Gateway
4. All other endpoints receive event(type=groups, subType=info)
end note
Gateway-->EPA: 200 OK (events)
note over Gateway, EPA
5. Add participant C to group.
end note
EPA -> Gateway:PUT /sessions/{sessionId}/groups/{groupId}/participants(participant)
Gateway-->EPA: 204 No Content

note over Gateway, EPC
6. Endpoint C receive invite on event channel which it respond by accepting invitation
end note

EPC -> Gateway:PUT /sessions/{sessionId}/groups/{groupId}(x-inviation=accept|decline)
Gateway-->EPC: 200 OK 

note over EPA, EPC
7. All other endpoints receive event(type=groups, subType=info) 
end note

note over EPA, EPC
8. Endpoint C leaves the chat group . 
end note
EPC -> Gateway:DELETE /sessions/{sessionId}/groups/{groupId}
Gateway-->EPC: 204 No Content 

note over EPA, EPC
9. All other endpoints receive event(type=groups, subType=info). If host leaves the group, it ends the group conversation.
end note
@enduml