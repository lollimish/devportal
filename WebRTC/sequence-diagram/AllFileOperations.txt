@startuml
title File Operations
hide footbox
participant "Endpoint A" as EPA
participant "AT&T API Gateway" as Gateway
participant "Endpoint B" as EPB

note over EPA, EPB
1. Endpoints have valid session established with gateway.
2. Endpoints have established event channel to get notification of network events. 
end note

note over EPA, Gateway
1. Endpoint A initiates file transer dialog with endpoint B.
   The file object in request body contains the destination details.
end note
EPA -> Gateway:POST /sessions/{sessionId}/files(file)
Gateway-->EPA: 202 Accepted (location)


note over Gateway, EPB
2. Endpoint B receives file transfer invitation event on event
   channel with following details.
   event(type=files, subType=transfer, state=invitation-received)
end note
Gateway-->EPB: 200 OK (events)

note over Gateway, EPB
3. Endpoint B respond by accepting the file transfer invitation request
end note
EPB -> Gateway:PUT /sessions/{sessionId}/files/{fileId}(x-inviation=accept)
Gateway-->EPB: 200 OK 


note over Gateway, EPA
4. Endpoint A receives file transfer session-open event on event
   channel with following details.
   event(type=files, subType=transfer, state=session-open)
end note
Gateway-->EPA: 200 OK (events)
note over Gateway, EPA
5. Endpoint A upload file
end note
EPA -> Gateway:PUT /sessions/{sessionId}/files/{fileId}(binary data in body)
Gateway-->EPA: 204 No Content

note over Gateway, EPB
6. Endpoint B download file
end note

EPB -> Gateway: GET /sessions/{sessionId}/files/{fileId}
Gateway-->EPB: 200 OK (data in body)



@enduml