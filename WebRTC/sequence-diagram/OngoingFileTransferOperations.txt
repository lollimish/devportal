@startuml
title Accept Invitation / Upload File Data Sequence
hide footbox
participant "Endpoint A" as EPA
participant "AT&T API Gateway" as Gateway

autonumber
note over EPA, Gateway
1. Endpoints have valid session established with gateway.
2. Endpoints have established event channel to get notification of network events. 

end note


loop Long polling 
EPA->Gateway: GET /sessions/{sessionId}/events
Gateway-->EPA: 200 OK (event)

note over Gateway, EPA
Event details.
1. File transfer invitation 
   event(type=files, subType=transfer, state=Invitation-received)
2. File transfer dialog is open for file upload 
   event(type=files, subType=transfer, state=session-open)
end note
end



alt Accept file transfer invitation
EPA -> Gateway:PUT /sessions/{sessionId}/files/{fileId}(x-inviation=accept)
Gateway-->EPA: 200 OK 
end
alt Upload file data sequence
EPA -> Gateway:PUT /sessions/{sessionId}/files/{fileId}(binary data in body)
Gateway-->EPA: 204 No Content
end

@enduml