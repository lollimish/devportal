@startuml

hide footbox

title  <b><u>Ongoing conference session handling</u></b>
participant "<b>WebRTC App" as browser
participant "<b>APIGW" as apig


note over browser  
 User is registered and 
does have a <b>session ID</b>
end note 
group 1. <b>Accept/Answer an media conference  
browser->apig : <b>HTTP PUT</b>   /v1/sessions/sessionId/conferences/{confId}(sdp,header:conference-answer)
note over apig 
    <b>"session-open"</b> - sent to conference
     participant(s)
end note
apig-->browser :HTTP 204 No Content (state:accepted)

end

note over browser  
1. User is registered and 
does have a <b>session ID</b>
2. state of conference is <b>"session-open".
end note 
group 2. <b>Initiate audio video session modifications  
browser->apig : <b>HTTP PUT</b>   /v1/sessions/sessionId/conferences/{confId}(sdp,header:initiate-conference-mod)
note over apig 
    modified SDP - sent to the peer
     
end note
apig-->browser :HTTP 204 No Content (state:mod-sent,modID)

end


note over browser  
1. User is registered and 
does have a <b>session ID</b>
2. state of conference is <b>"session-open".
end note 
group 3. <b>Initiate audio video conference HOLD  
browser->apig : <b>HTTP PUT</b>   /v1/sessions/sessionId/conferences/{confId}(sdp->a:recvonly,header:initiate-conference-hold)
note over apig 
    modified SDP[a:recvonly] - sent 
    to the peer
    
end note
apig-->browser :HTTP 204 No Content (state:mod-sent,modID)

end

note over browser  
1. User is registered and 
does have a <b>session ID</b>
2. state of conference is <b>"session-open".
end note 
group 4. <b>Initiate audio video conference RESUME  
browser->apig : <b>HTTP PUT</b>   /v1/sessions/sessionId/conferences/{confId}(sdp->a:sendrecv,header:initiate-conference-resume)
note over apig 
    modified SDP[a:sendrecv] - sent 
    to the  peer
    
end note
apig-->browser :HTTP 204 No Content (state:mod-sent,modID)

end


note over browser  
1. User is registered and 
does have a <b>session ID</b>
2. state of conference is <b>"session-open".
end note 
group 5. <b>Accept conference modification  
browser->apig : <b>HTTP PUT</b>   /v1/sessions/sessionId/conferences/{confId}(modID,sdp,header:accept-conference-mod)
note over apig 
    modified SDP,modID - sent 
    to the peer
    
end note
apig-->browser :HTTP 204 No Content (state:mod-accepted)

end

note over browser  
1. User is registered and 
does have a <b>session ID</b>
2. state of conference is <b>"session-open".
end note 
group 6. <b>Reject/Cancel conference modification  
browser->apig : <b>HTTP PUT</b>   /v1/sessions/sessionId/conferences/{confId}(modID,sdp,header:rejectCancel-conference-mod)
note over apig 
    Reject modID - sent 
    to the  peer
    
end note
apig-->browser :HTTP 204 No Content

end

note over browser  
1. User is registered and 
does have a <b>session ID</b>
2. state of call is <b>"session-open".
end note 
group 7. <b>Move media conference session to different end point  
group <b> PUT CALL ON HOLD
browser->apig : <b>HTTP PUT</b>   /v1/sessions/sessionId/conferences/{confId}(sdp->a:recvonly,header:initiate-call-hold)
note over apig 
    modified SDP[a:recvonly] - sent 
    to the  peer
    
end note
apig-->browser :HTTP 204 No Content (state:mod-sent,modID)
end

note over browser,apig
1. Other Endpoints having active session registered with same username/VTN/ICMN 
 starts ringing.
2. Conference is moved to the end point that answers the call first.
end note

end

@enduml